<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="favicon.png">
  <title>ZINGLENUT</title>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RG2WZFWJGV"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-RG2WZFWJGV');
  </script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      min-height: 100vh;
      font-family: system-ui, -apple-system, sans-serif;
      background: #000;
      color: #fff;
      padding: 2rem;
    }
    .page-content {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      gap: 2.5rem;
      align-items: start;
      max-width: 72rem;
      margin: 0 auto;
    }
    .map-panel {
      grid-column: 1;
      justify-self: start;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.25rem;
    }
    .map-panel .map-title {
      font-size: 1.35rem;
      font-weight: 600;
      margin-bottom: 0.2rem;
    }
    .map-panel .map-sub {
      font-size: 0.85rem;
      opacity: 0.7;
      margin-bottom: 0.5rem;
    }
    .map-frame {
      padding: 22px;
      background: linear-gradient(160deg, #252525 0%, #0a0a0a 50%, #151515 100%);
      border: 1px solid rgba(255,255,255,0.12);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.05),
        0 0 0 1px rgba(0,0,0,0.4),
        0 8px 32px rgba(0,0,0,0.6);
      border-radius: 14px;
    }
    .map-frame img {
      display: block;
      max-width: 560px;
      width: 100%;
      height: auto;
      border-radius: 8px;
      border: 1px solid rgba(0,0,0,0.3);
    }
    .map-download {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 1rem 2.25rem;
      font-size: 1.15rem;
      color: #fff;
      background: #222;
      border: 1px solid #444;
      border-radius: 8px;
      text-decoration: none;
      transition: background 0.2s, border-color 0.2s;
    }
    .map-download:hover {
      background: #2a2a2a;
      border-color: #555;
    }
    .main {
      grid-column: 2;
      max-width: 28rem;
      min-width: 0;
    }
    @media (max-width: 900px) {
      .page-content {
        grid-template-columns: 1fr;
        justify-items: center;
      }
      .map-panel { grid-column: 1; justify-self: center; }
      .main { grid-column: 1; }
    }
    h1 {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    .sub { font-size: 0.9rem; opacity: 0.7; margin-bottom: 2rem; }
    section {
      margin-bottom: 2.5rem;
    }
    section h2 {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 1rem;
      opacity: 0.9;
    }
    label { display: block; font-size: 0.85rem; opacity: 0.8; margin-bottom: 0.35rem; }
    input, select {
      width: 100%;
      padding: 0.5rem 0.75rem;
      font-size: 1rem;
      background: #222;
      border: 1px solid #444;
      color: #fff;
      border-radius: 4px;
      margin-bottom: 0.75rem;
    }
    input[type="datetime-local"] { margin-bottom: 0.75rem; }
    .row { display: flex; gap: 0.75rem; }
    .row > * { flex: 1; }
    .result {
      margin-top: 1rem;
      padding: 1rem;
      background: #1a1a1a;
      border-radius: 4px;
      font-size: 1rem;
      min-height: 2.5em;
    }
    .result.empty { opacity: 0.5; }
    .result strong { color: #fff; }

    .zinglenut-now {
      text-align: center;
      padding: 2.5rem 2rem;
      margin: -2rem -2rem 2.5rem -2rem;
      background: linear-gradient(180deg, rgba(255,255,255,0.06) 0%, transparent 100%);
      border-bottom: 1px solid rgba(255,255,255,0.12);
    }
    .zinglenut-now .label {
      font-size: 0.7rem;
      letter-spacing: 0.25em;
      text-transform: uppercase;
      opacity: 0.6;
      margin-bottom: 0.5rem;
    }
    .zinglenut-now .date {
      font-size: clamp(1.75rem, 5vw, 2.5rem);
      font-weight: 300;
      letter-spacing: 0.02em;
      margin-bottom: 0.25rem;
    }
    .zinglenut-now .date .month { font-weight: 600; opacity: 1; }
    .zinglenut-now .time {
      font-size: clamp(1.25rem, 4vw, 1.75rem);
      font-variant-numeric: tabular-nums;
      opacity: 0.9;
    }
  </style>
</head>
<body>
  <div class="zinglenut-now" aria-live="polite">
    <div class="label">Current ZINGLENUT time</div>
    <div class="date" id="zinglenutNowDate">—</div>
    <div class="time" id="zinglenutNowTime">—:—</div>
  </div>

  <div class="page-content">
  <aside class="map-panel">
    <h2 class="map-title">Borderless Map</h2>
    <p class="map-sub">Last Updated February 23rd 2026 (PST)</p>
    <div class="map-frame">
      <img src="mapborderless.png" alt="ZINGLENUT map">
    </div>
    <a href="mapborderless.png" download="mapborderless.png" class="map-download">Download Map</a>
  </aside>
  <div class="main">
  <h1>ZINGLENUT Time Converter</h1>
  <p class="sub">Aevum Victoria (A.V.) · Aevum Tenebrarum (A.T.) · Before Tenebrarum (B.T.)</p>

  <section>
    <h2>Real world time → ZINGLENUT time</h2>
    <label for="realInput">Date & time (Pacific time)</label>
    <input type="datetime-local" id="realInput" step="1">
    <p class="result" id="realToFicResult">Enter a date</p>
  </section>

  <section>
    <h2>ZINGLENUT time → Real world time</h2>
    <label>Era</label>
    <select id="ficEra">
      <option value="AV">Aevum Victoria (A.V.)</option>
      <option value="AT">Aevum Tenebrarum (A.T.)</option>
      <option value="BT">Before Tenebrarum (B.T.)</option>
    </select>
    <label for="ficYear">Year</label>
    <input type="number" id="ficYear" min="0" value="0" placeholder="e.g. 0">
    <label for="ficMonth">Month</label>
    <select id="ficMonth">
      <option value="0">Auriga</option>
      <option value="1">Caelum</option>
      <option value="2">Cepheus</option>
      <option value="3">Delphinus</option>
      <option value="4">Fornax</option>
      <option value="5">Lacerta</option>
      <option value="6">Mensa</option>
      <option value="7">Orion</option>
      <option value="8">Pisces</option>
      <option value="9">Sagitta</option>
    </select>
    <div class="row">
      <div>
        <label for="ficDay">Day (1–36)</label>
        <input type="number" id="ficDay" min="1" max="36" value="1">
      </div>
      <div>
        <label for="ficHour">Hour (0–23)</label>
        <input type="number" id="ficHour" min="0" max="23" value="0" placeholder="0">
      </div>
      <div>
        <label for="ficMin">Minute (0–59)</label>
        <input type="number" id="ficMin" min="0" max="59" value="0" placeholder="0">
      </div>
    </div>
    <p class="result" id="ficToRealResult">Enter values</p>
  </section>
  </div>
  </div>

  <script>
    // --- ZINGLENUT time constants ---
    const MONTHS = ['Auriga', 'Caelum', 'Cepheus', 'Delphinus', 'Fornax', 'Lacerta', 'Mensa', 'Orion', 'Pisces', 'Sagitta'];
    const SECONDS_PER_FIC_DAY = 6 * 3600;           // 21,600
    const SECONDS_PER_FIC_MONTH = 36 * SECONDS_PER_FIC_DAY;  // 777,600
    const SECONDS_PER_FIC_YEAR = 10 * SECONDS_PER_FIC_MONTH; // 7,776,000
    const FIC_DAY_HOURS = 24;  // 1 ZINGLENUT day = 6 real hours, subdivided into 24 ZINGLENUT hours

    // 0 A.V. = September 23, 2024 00:00:00 Pacific (America/Los_Angeles)
    // Sept 23 2024 is PDT (UTC-7), so 00:00 Pacific = 07:00 UTC
    const EPOCH_MS = Date.UTC(2024, 8, 23, 7, 0, 0, 0);

    // Pacific DST: 2nd Sunday March – 1st Sunday November (US rule)
    function isPacificDST(year, month1Based, day) {
      if (month1Based < 3 || month1Based > 11) return false;
      if (month1Based > 3 && month1Based < 11) return true;
      const firstSunday = (month) => {
        const d = (8 - new Date(year, month - 1, 1).getDay()) % 7;
        return d === 0 ? 7 : d;
      };
      if (month1Based === 3) return day >= firstSunday(3) + 7;
      return day < firstSunday(11);
    }
    function pacificToUtcMs(year, month1Based, day, hour, min, sec) {
      const offset = isPacificDST(year, month1Based, day) ? 7 : 8;
      return Date.UTC(year, month1Based - 1, day, hour + offset, min || 0, sec || 0);
    }

    function mod(a, b) {
      return ((a % b) + b) % b;
    }

    // --- Real → ZINGLENUT ---
    function realToFictional(utcMs) {
      const totalSeconds = (utcMs - EPOCH_MS) / 1000;
      const yearIndex = Math.floor(totalSeconds / SECONDS_PER_FIC_YEAR);
      let remainder = mod(totalSeconds, SECONDS_PER_FIC_YEAR);
      const monthIndex = Math.floor(remainder / SECONDS_PER_FIC_MONTH);
      remainder = mod(remainder, SECONDS_PER_FIC_MONTH);
      const dayIndex = Math.floor(remainder / SECONDS_PER_FIC_DAY);
      const secondsInDay = mod(remainder, SECONDS_PER_FIC_DAY);

      // ZINGLENUT time of day: 24 fic hours in 6 real hours → 1 zingle hour = 15 real min
      const ficHour = Math.floor((secondsInDay / SECONDS_PER_FIC_DAY) * FIC_DAY_HOURS);
      const ficMin = Math.floor(((secondsInDay / SECONDS_PER_FIC_DAY) * FIC_DAY_HOURS - ficHour) * 60);

      let era, yearLabel;
      if (yearIndex >= 0) {
        era = 'A.V.';
        yearLabel = yearIndex + ' ' + era;
      } else if (yearIndex >= -4500) {
        era = 'A.T.';
        yearLabel = (4500 + yearIndex + 1) + ' ' + era;  // -1 → 4500 A.T., -4500 → 1 A.T.
      } else {
        era = 'B.T.';
        yearLabel = (-yearIndex - 4501) + ' ' + era;     // -4502 → 1 B.T., -4503 → 2 B.T.
      }

      const day = dayIndex + 1;
      const monthName = MONTHS[monthIndex];
      const h = String(ficHour).padStart(2, '0');
      const m = String(ficMin).padStart(2, '0');
      return { era, yearLabel, monthName, day, time: h + ':' + m };
    }

    // --- Fictional → Real ---
    // A.T. is not reverse: 4500 A.T. directly precedes 0 A.V. (so 4500 A.T. = yearIndex -1).
    // B.T. is reverse: 1 B.T. precedes 0 A.T., 2 B.T. precedes 1 B.T., so B.T. Y = yearIndex -(4501+Y).
    function fictionalToReal(era, year, monthIndex, day, ficHour, ficMin) {
      let yearIndex;
      if (era === 'AV') {
        yearIndex = year;
      } else if (era === 'AT') {
        if (year < 1 || year > 4500) return null;
        yearIndex = -(4500 - year + 1);  // 4500 A.T. → -1, 1 A.T. → -4500
      } else {
        if (year < 1) return null;
        yearIndex = -(4501 + year);       // 1 B.T. → -4502, 2 B.T. → -4503
      }
      if (monthIndex < 0 || monthIndex > 9) return null;
      if (day < 1 || day > 36) return null;
      ficHour = ficHour || 0;
      ficMin = ficMin || 0;
      const secondsInDay = (ficHour / FIC_DAY_HOURS + ficMin / (FIC_DAY_HOURS * 60)) * SECONDS_PER_FIC_DAY;
      const totalSeconds =
        yearIndex * SECONDS_PER_FIC_YEAR +
        monthIndex * SECONDS_PER_FIC_MONTH +
        (day - 1) * SECONDS_PER_FIC_DAY +
        secondsInDay;
      return EPOCH_MS + totalSeconds * 1000;
    }

    // --- Live current ZINGLENUT time ---
    const zinglenutNowDateEl = document.getElementById('zinglenutNowDate');
    const zinglenutNowTimeEl = document.getElementById('zinglenutNowTime');
    function updateZinglenutNow() {
      const fic = realToFictional(Date.now());
      if (zinglenutNowDateEl) zinglenutNowDateEl.innerHTML = '<span class="month">' + fic.monthName + '</span> ' + fic.day + ', ' + fic.yearLabel;
      if (zinglenutNowTimeEl) zinglenutNowTimeEl.textContent = fic.time;
    }
    updateZinglenutNow();
    setInterval(updateZinglenutNow, 1000);

    // --- UI: Real → ZINGLENUT ---
    const realInput = document.getElementById('realInput');
    const realToFicResult = document.getElementById('realToFicResult');

    const pacificFmt = new Intl.DateTimeFormat('en-CA', {
      timeZone: 'America/Los_Angeles',
      year: 'numeric', month: '2-digit', day: '2-digit',
      hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false
    });
    function formatRealDatePacific(utcMs) {
      const d = new Date(utcMs);
      const parts = pacificFmt.formatToParts(d);
      const get = (t) => (parts.find(p => p.type === t) || {}).value || '';
      return get('year') + '-' + get('month') + '-' + get('day') + ' ' + get('hour') + ':' + get('minute') + ':' + get('second');
    }

    realInput.addEventListener('input', function () {
      const value = realInput.value;
      if (!value) {
        realToFicResult.textContent = 'Enter a date';
        realToFicResult.classList.add('empty');
        return;
      }
      const [datePart, timePart] = value.split('T');
      if (!datePart) {
        realToFicResult.textContent = 'Invalid date';
        realToFicResult.classList.add('empty');
        return;
      }
      const [y, m, d] = datePart.split('-').map(Number);
      const [h, min] = (timePart || '0:0').split(':').map(Number);
      const utcMs = pacificToUtcMs(y, m, d, h, min);
      if (isNaN(utcMs) || utcMs < 0) {
        realToFicResult.textContent = 'Invalid date';
        realToFicResult.classList.add('empty');
        return;
      }
      const fic = realToFictional(utcMs);
      realToFicResult.innerHTML = '<strong>' + fic.monthName + ' ' + fic.day + ', ' + fic.yearLabel + '</strong> at ' + fic.time;
      realToFicResult.classList.remove('empty');
    });

    // --- UI: ZINGLENUT → Real ---
    const ficEra = document.getElementById('ficEra');
    const ficYear = document.getElementById('ficYear');
    const ficMonth = document.getElementById('ficMonth');
    const ficDay = document.getElementById('ficDay');
    const ficHour = document.getElementById('ficHour');
    const ficMin = document.getElementById('ficMin');
    const ficToRealResult = document.getElementById('ficToRealResult');

    function updateFicToReal() {
      const era = ficEra.value;
      const year = parseInt(ficYear.value, 10);
      const monthIndex = parseInt(ficMonth.value, 10);
      const day = parseInt(ficDay.value, 10);
      const hour = parseInt(ficHour.value, 10) || 0;
      const min = parseInt(ficMin.value, 10) || 0;
      if (era === 'AV' && (isNaN(year) || year < 0)) {
        ficToRealResult.textContent = 'Enter a valid A.V. year (≥ 0)';
        ficToRealResult.classList.add('empty');
        return;
      }
      if (era === 'AT' && (isNaN(year) || year < 1 || year > 4500)) {
        ficToRealResult.textContent = 'Enter a valid A.T. year (1–4500)';
        ficToRealResult.classList.add('empty');
        return;
      }
      if (era === 'BT' && (isNaN(year) || year < 1)) {
        ficToRealResult.textContent = 'Enter a valid B.T. year (≥ 1)';
        ficToRealResult.classList.add('empty');
        return;
      }
      const utcMs = fictionalToReal(era, year, monthIndex, day, hour, min);
      if (utcMs == null) {
        ficToRealResult.textContent = 'Invalid fictional date';
        ficToRealResult.classList.add('empty');
        return;
      }
      ficToRealResult.textContent = formatRealDatePacific(utcMs) + ' Pacific';
      ficToRealResult.classList.remove('empty');
    }

    [ficEra, ficYear, ficMonth, ficDay, ficHour, ficMin].forEach(el => el.addEventListener('input', updateFicToReal));
    [ficEra, ficYear, ficMonth, ficDay, ficHour, ficMin].forEach(el => el.addEventListener('change', updateFicToReal));
    updateFicToReal();
  </script>
</body>
</html>
